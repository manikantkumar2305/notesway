// Dummy file data
export const files = [
  {
    id: 1,
    title: 'Introduction to Data Structures',
    key: 'CS_1_DataStructures_2024',
    subject: 'Computer Science',
    unit: 'Unit 1',
    topic: 'Data Structures Basics',
    description: 'Comprehensive notes on arrays, linked lists, stacks, and queues with examples.',
    keywords: ['data structures', 'arrays', 'linked lists', 'stacks', 'queues'],
    uploaderRole: 'professor',
    uploaderName: 'Dr. Ramesh Rao',
    uploaderId: 4,
    collegeId: 'C001',
    yearSemester: '2024 Semester 1',
    downloadUrl: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf',
    uploadedAt: '2024-01-15'
  },
  {
    id: 2,
    title: 'Database Management Systems - SQL Basics',
    key: 'CS_2_DBMS_2024',
    subject: 'Computer Science',
    unit: 'Unit 2',
    topic: 'SQL Fundamentals',
    description: 'Complete guide to SQL queries, joins, and database design principles.',
    keywords: ['database', 'sql', 'dbms', 'queries', 'normalization'],
    uploaderRole: 'student',
    uploaderName: 'Manikant Sharma',
    uploaderId: 2,
    collegeId: 'C001',
    yearSemester: '2024 Semester 1',
    downloadUrl: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf',
    uploadedAt: '2024-01-20'
  },
  {
    id: 3,
    title: 'Operating Systems - Process Management',
    key: 'CS_3_OS_2024',
    subject: 'Computer Science',
    unit: 'Unit 3',
    topic: 'Process and Thread Management',
    description: 'Detailed notes on process scheduling, synchronization, and deadlock handling.',
    keywords: ['operating systems', 'processes', 'threads', 'scheduling', 'deadlock'],
    uploaderRole: 'professor',
    uploaderName: 'Dr. Ramesh Rao',
    uploaderId: 4,
    collegeId: 'C001',
    yearSemester: '2024 Semester 1',
    downloadUrl: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf',
    uploadedAt: '2024-01-25'
  },
  {
    id: 4,
    title: 'Calculus - Differential Equations',
    key: 'MATH_1_Calculus_2024',
    subject: 'Mathematics',
    unit: 'Unit 1',
    topic: 'Differential Equations',
    description: 'Solutions and methods for solving first and second-order differential equations.',
    keywords: ['calculus', 'differential equations', 'mathematics', 'derivatives'],
    uploaderRole: 'professor',
    uploaderName: 'Dr. Sarah Johnson',
    uploaderId: 5,
    collegeId: 'C001',
    yearSemester: '2024 Semester 1',
    downloadUrl: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf',
    uploadedAt: '2024-02-01'
  },
  {
    id: 5,
    title: 'Web Development - React Fundamentals',
    key: 'CS_4_WebDev_2024',
    subject: 'Computer Science',
    unit: 'Unit 4',
    topic: 'React and Modern JavaScript',
    description: 'Complete guide to React hooks, components, and state management.',
    keywords: ['react', 'javascript', 'web development', 'frontend', 'hooks'],
    uploaderRole: 'student',
    uploaderName: 'Priya Patel',
    uploaderId: 3,
    collegeId: 'C001',
    yearSemester: '2024 Semester 1',
    downloadUrl: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf',
    uploadedAt: '2024-02-05'
  },
  {
    id: 6,
    title: 'Computer Networks - TCP/IP Protocol',
    key: 'CS_5_Networks_2024',
    subject: 'Computer Science',
    unit: 'Unit 5',
    topic: 'Network Protocols',
    description: 'In-depth coverage of TCP/IP, OSI model, and network security basics.',
    keywords: ['networking', 'tcp/ip', 'protocols', 'osi model', 'security'],
    uploaderRole: 'professor',
    uploaderName: 'Dr. Ramesh Rao',
    uploaderId: 4,
    collegeId: 'C001',
    yearSemester: '2024 Semester 1',
    downloadUrl: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf',
    uploadedAt: '2024-02-10'
  },
  {
    id: 7,
    title: 'Machine Learning - Supervised Learning',
    key: 'CS_6_ML_2024',
    subject: 'Computer Science',
    unit: 'Unit 6',
    topic: 'Classification and Regression',
    description: 'Notes on linear regression, logistic regression, and decision trees.',
    keywords: ['machine learning', 'ai', 'supervised learning', 'regression', 'classification'],
    uploaderRole: 'student',
    uploaderName: 'Manikant Sharma',
    uploaderId: 2,
    collegeId: 'C001',
    yearSemester: '2024 Semester 2',
    downloadUrl: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf',
    uploadedAt: '2024-02-15'
  },
  {
    id: 8,
    title: 'Software Engineering - Agile Methodology',
    key: 'CS_7_SE_2024',
    subject: 'Computer Science',
    unit: 'Unit 7',
    topic: 'Agile and Scrum',
    description: 'Understanding agile principles, scrum framework, and sprint planning.',
    keywords: ['software engineering', 'agile', 'scrum', 'methodology', 'sdlc'],
    uploaderRole: 'professor',
    uploaderName: 'Dr. Ramesh Rao',
    uploaderId: 4,
    collegeId: 'C001',
    yearSemester: '2024 Semester 2',
    downloadUrl: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf',
    uploadedAt: '2024-02-20'
  },
  {
    id: 9,
    title: 'Linear Algebra - Matrices and Vectors',
    key: 'MATH_2_LinearAlgebra_2024',
    subject: 'Mathematics',
    unit: 'Unit 2',
    topic: 'Matrix Operations',
    description: 'Comprehensive guide to matrix multiplication, determinants, and eigenvalues.',
    keywords: ['linear algebra', 'matrices', 'vectors', 'eigenvalues', 'mathematics'],
    uploaderRole: 'professor',
    uploaderName: 'Dr. Sarah Johnson',
    uploaderId: 5,
    collegeId: 'C001',
    yearSemester: '2024 Semester 2',
    downloadUrl: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf',
    uploadedAt: '2024-02-25'
  },
  {
    id: 10,
    title: 'Physics - Quantum Mechanics Intro',
    key: 'PHY_1_Quantum_2024',
    subject: 'Physics',
    unit: 'Unit 1',
    topic: 'Quantum Theory Basics',
    description: 'Introduction to wave-particle duality, uncertainty principle, and quantum states.',
    keywords: ['physics', 'quantum mechanics', 'wave-particle duality', 'uncertainty'],
    uploaderRole: 'professor',
    uploaderName: 'Dr. Ramesh Rao',
    uploaderId: 4,
    collegeId: 'C001',
    yearSemester: '2024 Semester 2',
    downloadUrl: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf',
    uploadedAt: '2024-03-01'
  },
  {
    id: 11,
    title: 'Cloud Computing - AWS Fundamentals',
    key: 'CS_8_Cloud_2024',
    subject: 'Computer Science',
    unit: 'Unit 8',
    topic: 'Cloud Services and Architecture',
    description: 'Introduction to AWS services, EC2, S3, and cloud deployment strategies.',
    keywords: ['cloud computing', 'aws', 'ec2', 's3', 'devops'],
    uploaderRole: 'student',
    uploaderName: 'Priya Patel',
    uploaderId: 3,
    collegeId: 'C001',
    yearSemester: '2024 Semester 2',
    downloadUrl: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf',
    uploadedAt: '2024-03-05'
  },
  {
    id: 12,
    title: 'Cybersecurity - Ethical Hacking Basics',
    key: 'CS_9_Security_2024',
    subject: 'Computer Science',
    unit: 'Unit 9',
    topic: 'Network Security and Penetration Testing',
    description: 'Learn about common vulnerabilities, penetration testing tools, and security best practices.',
    keywords: ['cybersecurity', 'ethical hacking', 'penetration testing', 'security', 'vulnerabilities'],
    uploaderRole: 'professor',
    uploaderName: 'Dr. Ramesh Rao',
    uploaderId: 4,
    collegeId: 'C001',
    yearSemester: '2024 Semester 2',
    downloadUrl: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf',
    uploadedAt: '2024-03-10'
  }
];

export const addFile = (fileData) => {
  const newFile = {
    id: files.length + 1,
    uploadedAt: new Date().toISOString().split('T')[0],
    ...fileData
  };
  files.push(newFile);
  return newFile;
};

export const getFileById = (id) => {
  return files.find(f => f.id === parseInt(id));
};

export const getFilesByCollege = (collegeId) => {
  return files.filter(f => f.collegeId === collegeId);
};

export const searchFiles = (query, collegeId) => {
  const lowerQuery = query.toLowerCase();
  return files.filter(f => 
    f.collegeId === collegeId && (
      f.title.toLowerCase().includes(lowerQuery) ||
      f.subject.toLowerCase().includes(lowerQuery) ||
      f.key.toLowerCase().includes(lowerQuery) ||
      f.keywords.some(k => k.toLowerCase().includes(lowerQuery)) ||
      f.description.toLowerCase().includes(lowerQuery) ||
      f.uploaderName.toLowerCase().includes(lowerQuery)
    )
  );
};

export const deleteFile = (id, currentUserId, currentUserRole) => {
  const index = files.findIndex(f => f.id === parseInt(id));
  if (index !== -1) {
    const file = files[index];
    
    // Permission check:
    // - Admin can delete any file
    // - Professor can delete their own files or student files
    // - Student can only delete their own files
    
    if (currentUserRole === 'admin') {
      // Admin can delete any file
      files.splice(index, 1);
      return { success: true, message: 'File deleted successfully' };
    } else if (currentUserRole === 'professor') {
      // Professor can delete their own files or student files
      if (file.uploaderId === currentUserId || file.uploaderRole === 'student') {
        files.splice(index, 1);
        return { success: true, message: 'File deleted successfully' };
      } else {
        return { success: false, error: 'You can only delete your own files or student files' };
      }
    } else if (currentUserRole === 'student') {
      // Student can only delete their own files
      if (file.uploaderId === currentUserId) {
        files.splice(index, 1);
        return { success: true, message: 'File deleted successfully' };
      } else {
        return { success: false, error: 'You can only delete your own files' };
      }
    } else {
      return { success: false, error: 'Unauthorized' };
    }
  }
  return { success: false, error: 'File not found' };
};

export const updateFile = (id, updates) => {
  const index = files.findIndex(f => f.id === parseInt(id));
  if (index !== -1) {
    files[index] = { ...files[index], ...updates };
    return files[index];
  }
  return null;
};